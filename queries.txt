1. Seleziona gli utenti che hanno postato almeno un video

SELECT u.username 
FROM users u 
JOIN medias m 
ON m.user_id = u.id 
JOIN media_post mp 
ON mp.media_id = m.id 
JOIN posts p 
ON p.id = mp.post_id 
WHERE m.`type` = "video"
GROUP BY u.username 
;

2. Seleziona tutti i post senza Like (13)

SELECT *
FROM posts p 
LEFT JOIN likes l 
ON l.post_id = p.id
WHERE l.post_id IS NULL 
;

3.Conta il numero di like per ogni post (152)

SELECT COUNT(*) AS "numero di like per post", p.id, p.title , p.`date` 
FROM likes l 
JOIN posts p 
ON p.id = l.post_id 
GROUP BY p.id
;

Questa versione restituisce 152 record in output ma conta solo i post che hanno ALMENO 1 like. 
Spulciando tra i dati delle tabelle ho notato che ci sono alcuni posto che non hanno alcun like.
Se vogliamo vedere anche questi post, si può provare un’altra variante che restituisce invece 165 risultati, sfruttando una Left Outer Join.

SELECT p.id, p.title , p.`date`, COUNT(l.post_id) AS "numero_di_like_per_post"
FROM posts p 
LEFT JOIN likes l 
ON p.id = l.post_id 
GROUP BY p.id, p.title, p.`date`
ORDER BY numero_di_like_per_post
;

4.Ordina gli utenti per il numero di media caricati (25) 

SELECT u.username, COUNT(m.id) AS "loaded_medias"
FROM users u 
JOIN medias m 
ON m.user_id = u.id 
GROUP BY u.username 
ORDER BY loaded_medias DESC
;


5.Ordina gli utenti per totale di likes ricevuti nei loro posts (25) 

SELECT u.username, COUNT(l.post_id) AS "likes" 
FROM users u 
LEFT JOIN posts p 
ON p.user_id = u.id 
LEFT JOIN likes l 
ON l.post_id = p.id 
GROUP BY u.username
ORDER BY likes DESC
;

Ho usato la left join in modo tale da includere tutti gli utenti, anche quelli senza post pubblicati e considerare tutti i post, anche quelli senza likes. In entrambe le situazioni così la query ci restituirebbe valore 0 in “likes”.
